# 📚 ISR 캐시 시스템 이해하기 (비개발자용)

## 🎯 이 문서는 누구를 위한 건가요?

코딩을 모르는 분들도 이해할 수 있도록 쉽게 설명한 문서입니다.  
"왜 내가 수정한 내용이 웹사이트에 안 보일까?" 같은 궁금증을 해결해드립니다.

---

## 📖 간단한 비유: 도서관의 책 정리 시스템

### 일반적인 웹사이트 (전통적인 방식)
- **비유**: 매번 방문할 때마다 도서관 사서가 책을 새로 찾아서 읽어줌
- **문제**: 방문할 때마다 시간이 오래 걸림 (3초~5초)
- **장점**: 항상 최신 정보

### CareerWiki의 ISR 방식
- **비유**: 한 번 읽은 책은 도서관 사서가 미리 정리해둠. 다음 방문자는 그 정리된 책을 바로 가져다 줌
- **장점**: 매우 빠름 (0.05초)
- **주의**: 책 내용이 바뀌면 정리된 책을 새로 만들어야 함

---

## 🔄 ISR 캐시가 작동하는 방식

### 1단계: 첫 방문자 (캐시 MISS)

```
사용자: "간호학과 페이지 보여주세요"
    ↓
서버: "오, 처음 보는 페이지네요. 잠깐만요..."
    ↓
서버: [데이터베이스에서 정보 가져오기] (0.2초)
    ↓
서버: [웹페이지 만들기] (0.1초)
    ↓
서버: [만든 페이지를 캐시에 저장] (0.05초)
    ↓
사용자: "완성된 페이지 받음" ✅
```

**총 시간**: 약 0.35초

### 2단계: 두 번째 방문자부터 (캐시 HIT)

```
사용자: "간호학과 페이지 보여주세요"
    ↓
서버: "아, 이거 전에 만들어둔 게 있네요!"
    ↓
서버: [캐시에서 바로 가져오기] (0.05초)
    ↓
사용자: "완성된 페이지 받음" ✅
```

**총 시간**: 약 0.05초 (7배 빠름!)

---

## ⚠️ 문제 상황: 왜 수정한 내용이 안 보일까?

### 시나리오: 템플릿을 수정했는데 안 보임

**발생한 일:**

1. **개발자가 코드 수정** (예: "고교 추천 교과목" 섹션 추가)
2. **서버 재시작**
3. **웹사이트 방문** → 여전히 옛날 내용만 보임 😱

**왜 이런 일이?**

```
[과거] 캐시에 저장된 페이지 (옛날 버전)
    "간호학과" 페이지 내용...
    - 전공 개요 ✅
    - 취업률 ✅
    - 고교 추천 교과목 ❌ (없음)
    
[현재] 새로 만든 페이지 (새 버전)
    "간호학과" 페이지 내용...
    - 전공 개요 ✅
    - 취업률 ✅
    - 고교 추천 교과목 ✅ (새로 추가됨!)
```

**문제**: 캐시에 **옛날 버전**이 남아있어서, 서버가 "아, 이미 만들어둔 게 있네요!"라고 생각하고 옛날 버전을 그대로 보여줌

---

## ✅ 해결 방법

### 방법 1: 캐시 삭제 (수동)

개발자가 데이터베이스에서 해당 페이지의 캐시를 직접 삭제합니다.

```
캐시 삭제 명령 실행
    ↓
다음 방문자부터 새로 페이지 생성
    ↓
새 버전이 캐시에 저장됨
    ↓
이제 모든 방문자가 새 버전을 봄 ✅
```

### 방법 2: 템플릿 버전 올리기 (자동)

개발자가 특정 파일의 숫자를 올리면, 시스템이 자동으로 "아, 템플릿이 바뀌었구나!"를 인식하고 모든 캐시를 무효화합니다.

```
템플릿 버전: 22 → 23 (숫자 하나 올림)
    ↓
시스템: "버전이 바뀌었네? 모든 캐시 무효화!"
    ↓
다음 방문자부터 새로 페이지 생성
    ↓
새 버전이 캐시에 저장됨 ✅
```

---

## 🛡️ 재발 방지: 자동화 시스템

### 개발 모드에서 자동 캐시 무효화

개발 중에는 항상 최신 데이터를 보기 위해, 개발 모드에서는 캐시를 사용하지 않도록 설정했습니다.

```
개발 모드 감지
    ↓
캐시 무시하고 항상 새로 생성
    ↓
개발자가 수정한 내용이 즉시 반영됨 ✅
```

### 템플릿 파일 변경 감지

템플릿 파일을 수정하면 자동으로 버전이 올라가도록 설정할 수 있습니다 (선택 사항).

---

## 📊 성능 비교

| 상황 | 전통적인 방식 | ISR 캐시 방식 |
|------|--------------|--------------|
| 첫 방문 | 0.3~0.5초 | 0.3~0.5초 (동일) |
| 두 번째 방문 | 0.3~0.5초 | 0.05초 (6~10배 빠름!) |
| 1000명 동시 접속 | 서버 과부하 가능 | 부하 없음 (캐시 사용) |

---

## 🎓 핵심 개념 정리

### 캐시 (Cache)
- **의미**: 자주 사용하는 데이터를 빠른 곳에 미리 저장해두는 것
- **비유**: 자주 찾는 책을 책상 위에 올려두는 것

### ISR (Incremental Static Regeneration)
- **의미**: 필요할 때만 페이지를 새로 만들어서 캐시에 저장하는 방식
- **장점**: 빠르고, 서버 부하가 적음
- **주의**: 내용이 바뀌면 캐시도 업데이트해야 함

### 템플릿 버전
- **의미**: 페이지 디자인이 몇 번째 버전인지 나타내는 숫자
- **용도**: 디자인이 바뀌었는지 자동으로 감지

---

## ❓ 자주 묻는 질문

### Q1: 캐시를 삭제하면 모든 페이지가 느려지나요?
**A**: 아니요. 각 페이지는 독립적으로 캐시됩니다. 한 페이지의 캐시를 삭제해도 다른 페이지는 영향 없습니다.

### Q2: 캐시는 언제 자동으로 업데이트되나요?
**A**: 템플릿 버전이 올라가면 자동으로 무효화됩니다. 또는 개발자가 수동으로 삭제할 수 있습니다.

### Q3: 사용자가 옛날 버전을 계속 볼 수 있나요?
**A**: 아니요. 캐시가 무효화되면 다음 방문자부터는 모두 새 버전을 봅니다.

### Q4: 개발 중에는 어떻게 하나요?
**A**: 개발 모드에서는 자동으로 캐시를 무시하고 항상 최신 데이터를 보여줍니다.

---

## 📝 요약

1. **ISR 캐시**는 빠른 웹사이트를 위한 필수 시스템입니다
2. **템플릿을 수정**하면 캐시도 업데이트해야 합니다
3. **개발 모드**에서는 자동으로 최신 데이터를 보여줍니다
4. **템플릿 버전**을 올리면 모든 캐시가 자동으로 무효화됩니다

---

**작성일**: 2025-01-30  
**작성자**: CareerWiki 개발팀  
**최종 수정**: 2025-01-30

